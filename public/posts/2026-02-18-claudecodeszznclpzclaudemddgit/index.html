<!DOCTYPE html>
<html lang="en" dir="auto" data-theme="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="noindex, nofollow">
<title>Claude Codeå®æˆ˜æŒ‡å—ï¼šä»é›¶é…ç½®CLAUDE.mdåˆ°Gité¢„æäº¤AIæ ¡éªŒ | æ™ºé€šå’Œä½ ä¸€èµ·å­¦AI</title>
<meta name="keywords" content="Claude, AIç¼–ç¨‹, Gité’©å­, Python, DevOps, APIé›†æˆ">
<meta name="description" content="æœ¬æŒ‡å—è¯¦è§£å¦‚ä½•ä»é›¶é…ç½®Claude APIï¼Œåˆ›å»ºCLAUDE.mdè§„èŒƒï¼Œå¹¶é›†æˆAIæ ¡éªŒåˆ°Gité¢„æäº¤é’©å­ï¼Œæå‡ä»£ç è´¨é‡ä¸å›¢é˜Ÿåä½œæ•ˆç‡ã€‚">
<meta name="author" content="æ™ºé€š">
<link rel="canonical" href="http://localhost:1313/posts/2026-02-18-claudecodeszznclpzclaudemddgit/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.da3211e5ef867bf2b75fd5a6515cfed7195c011e8ab735694e203810a827097b.css" integrity="sha256-2jIR5e&#43;Ge/K3X9WmUVz&#43;1xlcAR6KtzVpTiA4EKgnCXs=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/posts/2026-02-18-claudecodeszznclpzclaudemddgit/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
                color-scheme: dark;
            }

            .list {
                background: var(--theme);
            }

            .toc {
                background: var(--entry);
            }
        }

        @media (prefers-color-scheme: light) {
            .list::-webkit-scrollbar-thumb {
                border-color: var(--code-bg);
            }
        }

    </style>
</noscript>
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.querySelector("html").dataset.theme = 'dark';
    } else if (localStorage.getItem("pref-theme") === "light") {
       document.querySelector("html").dataset.theme = 'light';
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.querySelector("html").dataset.theme = 'dark';
    } else {
        document.querySelector("html").dataset.theme = 'light';
    }

</script>
<script defer src='https://static.cloudflareinsights.com/beacon.min.js' 
        data-cf-beacon='{"token": "ä½ çš„token"}'></script>


</head>
<body id="top">
    <header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="æ™ºé€šå’Œä½ ä¸€èµ·å­¦AI (Alt + H)">æ™ºé€šå’Œä½ ä¸€èµ·å­¦AI</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/" title="é¦–é¡µ">
                    <span>é¦–é¡µ</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/posts/" title="æ–‡ç« ">
                    <span>æ–‡ç« </span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/archives/" title="å½’æ¡£">
                    <span>å½’æ¡£</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/tags/" title="æ ‡ç­¾">
                    <span>æ ‡ç­¾</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/about/" title="å…³äº">
                    <span>å…³äº</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      Claude Codeå®æˆ˜æŒ‡å—ï¼šä»é›¶é…ç½®CLAUDE.mdåˆ°Gité¢„æäº¤AIæ ¡éªŒ
    </h1>
    <div class="post-description">
      æœ¬æŒ‡å—è¯¦è§£å¦‚ä½•ä»é›¶é…ç½®Claude APIï¼Œåˆ›å»ºCLAUDE.mdè§„èŒƒï¼Œå¹¶é›†æˆAIæ ¡éªŒåˆ°Gité¢„æäº¤é’©å­ï¼Œæå‡ä»£ç è´¨é‡ä¸å›¢é˜Ÿåä½œæ•ˆç‡ã€‚
    </div>
    <div class="post-meta"><span title='2026-02-18 05:44:20.652 +0000 UTC'>February 18, 2026</span>&nbsp;Â·&nbsp;<span>æ™ºé€š</span>

</div>
  </header> 
  <div class="post-content"><h2 id="1-ç¯å¢ƒå‡†å¤‡ä¸claude-apiæ¥å…¥">1. ç¯å¢ƒå‡†å¤‡ä¸Claude APIæ¥å…¥<a hidden class="anchor" aria-hidden="true" href="#1-ç¯å¢ƒå‡†å¤‡ä¸claude-apiæ¥å…¥">#</a></h2>
<p>è®©æˆ‘ä»¬ä»é›¶å¼€å§‹ï¼Œå¿«é€Ÿæ‰“é€šæœ¬åœ°å¼€å‘ç¯å¢ƒä¸ Claude çš„ AI èƒ½åŠ›ã€‚è¿™ä¸€æ­¥æ˜¯åç»­æ‰€æœ‰è‡ªåŠ¨åŒ–èƒ½åŠ›çš„åœ°åŸºï¼ŒåŠ¡å¿…ç¨³æ‰ç¨³æ‰“ã€‚</p>
<p>é¦–å…ˆå®‰è£…å®˜æ–¹ SDKï¼ˆæ¨èä½¿ç”¨ Python 3.9+ï¼‰ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>pip install anthropic python-dotenv
</span></span></code></pre></div><blockquote>
<p>âœ… <code>python-dotenv</code> éå¿…éœ€ä½†å¼ºçƒˆæ¨èâ€”â€”å®ƒèƒ½å®‰å…¨åŠ è½½ <code>.env</code> æ–‡ä»¶ï¼Œé¿å… API Key ç¡¬ç¼–ç æˆ–æ„å¤–æäº¤ã€‚</p>
</blockquote>
<p>æ¥ç€ï¼Œè®¿é—® <a href="https://console.anthropic.com">Anthropic Console</a> â†’ <strong>API Keys</strong> â†’ ç‚¹å‡» <strong>Create Key</strong>ï¼Œå¤åˆ¶ç”Ÿæˆçš„å¯†é’¥ï¼ˆå½¢å¦‚ <code>sk-ant-api03-...</code>ï¼‰ã€‚<strong>åˆ‡å‹¿æˆªå›¾ã€å‹¿å­˜ GitHubã€å‹¿å‘ç¾¤èŠï¼</strong></p>
<p>åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»º <code>.env</code> æ–‡ä»¶ï¼ˆæ³¨æ„ï¼šæ–‡ä»¶åä»¥ <code>.</code> å¼€å¤´ï¼Œéšè—ï¼‰ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-env" data-lang="env"><span style="display:flex;"><span>ANTHROPIC_API_KEY<span style="color:#f92672">=</span>sk-ant-api03-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
</span></span></code></pre></div><p>æœ€åï¼Œç¼–å†™æœ€å°éªŒè¯è„šæœ¬ <code>test_claude.py</code>ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># test_claude.py</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> os
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> dotenv <span style="color:#f92672">import</span> load_dotenv
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> anthropic
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>load_dotenv()  <span style="color:#75715e"># åŠ è½½ .env ä¸­çš„ ANTHROPIC_API_KEY</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>client <span style="color:#f92672">=</span> anthropic<span style="color:#f92672">.</span>Anthropic()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>    message <span style="color:#f92672">=</span> client<span style="color:#f92672">.</span>messages<span style="color:#f92672">.</span>create(
</span></span><span style="display:flex;"><span>        model<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;claude-3-5-sonnet-20240620&#34;</span>,
</span></span><span style="display:flex;"><span>        max_tokens<span style="color:#f92672">=</span><span style="color:#ae81ff">100</span>,
</span></span><span style="display:flex;"><span>        messages<span style="color:#f92672">=</span>[{<span style="color:#e6db74">&#34;role&#34;</span>: <span style="color:#e6db74">&#34;user&#34;</span>, <span style="color:#e6db74">&#34;content&#34;</span>: <span style="color:#e6db74">&#34;è¯·ç”¨ä¸­æ–‡è¯´ä¸€å¥æ‰“æ‹›å‘¼çš„è¯&#34;</span>}]
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;âœ… æˆåŠŸè°ƒç”¨ Claudeï¼š&#34;</span>, message<span style="color:#f92672">.</span>content[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>text<span style="color:#f92672">.</span>strip())
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">except</span> <span style="color:#a6e22e">Exception</span> <span style="color:#66d9ef">as</span> e:
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;âŒ è°ƒç”¨å¤±è´¥ï¼š&#34;</span>, e)
</span></span></code></pre></div><p>è¿è¡Œ <code>python test_claude.py</code>ï¼Œåº”è¾“å‡ºç±»ä¼¼ï¼š<br>
<code>âœ… æˆåŠŸè°ƒç”¨ Claudeï¼šä½ å¥½ï¼æˆ‘æ˜¯ Claudeï¼Œå¾ˆé«˜å…´ä¸ºä½ æä¾›å¸®åŠ©ã€‚</code></p>
<p><img alt="å±•ç¤º test_claude.py è¿è¡ŒæˆåŠŸçš„ç»ˆç«¯æˆªå›¾" loading="lazy" src="IMAGE_PLACEHOLDER_1"></p>
<p>âš ï¸ <strong>å…³é”®æ³¨æ„äº‹é¡¹</strong>ï¼š</p>
<ul>
<li>Anthropic API å½“å‰<strong>ä»…æ”¯æŒ <code>us-east-1</code> åŒºåŸŸ</strong>ï¼Œè‹¥ä½¿ç”¨ä»£ç†/ä¼ä¸šç½‘å…³ï¼Œè¯·ç¡®ä¿å‡ºå£ IP å¯è¾¾è¯¥åŒºåŸŸï¼›</li>
<li>å…è´¹é¢åº¦ä¸ºæ–°è´¦å·èµ é€ $5ï¼ˆçº¦å¯å¤„ç† 50 ä¸‡è¾“å…¥ tokensï¼‰ï¼Œå¯åœ¨ <a href="https://console.anthropic.com/usage">Console â†’ Usage</a> å®æ—¶æŸ¥çœ‹ï¼›</li>
<li>API Key æƒé™é»˜è®¤ä¸º <code>full_access</code>ï¼Œç”Ÿäº§ç¯å¢ƒå»ºè®®åœ¨ Console ä¸­åˆ›å»ºæœ€å°æƒé™ Keyï¼ˆç›®å‰æš‚ä¸æ”¯æŒç»†ç²’åº¦ RBACï¼‰ã€‚</li>
</ul>
<p>â“ <strong>å¸¸è§é—®é¢˜é€ŸæŸ¥</strong>ï¼š</p>
<ul>
<li><code>AuthenticationError: Invalid API key</code>ï¼Ÿæ£€æŸ¥ <code>.env</code> æ˜¯å¦è¢«æ­£ç¡®åŠ è½½ï¼ˆ<code>print(os.getenv(&quot;ANTHROPIC_API_KEY&quot;))</code>ï¼‰ã€Key å‰åæœ‰æ— ç©ºæ ¼æˆ–æ¢è¡Œï¼›</li>
<li>ä¼ä¸šå†…ç½‘æ— æ³•è¿æ¥ï¼Ÿé…ç½®ç³»ç»Ÿçº§ HTTP ä»£ç†ï¼š<code>export HTTP_PROXY=http://your-proxy:8080</code>ï¼ˆLinux/macOSï¼‰æˆ–åœ¨ä»£ç ä¸­æ˜¾å¼ä¼ å…¥ <code>httpx.Client(transport=...)</code>ã€‚</li>
</ul>
<hr>
<h2 id="2-åˆ›å»º-claudemdé¡¹ç›®çº§aiåä½œè§„èŒƒæ–‡ä»¶">2. åˆ›å»º CLAUDE.mdï¼šé¡¹ç›®çº§AIåä½œè§„èŒƒæ–‡ä»¶<a hidden class="anchor" aria-hidden="true" href="#2-åˆ›å»º-claudemdé¡¹ç›®çº§aiåä½œè§„èŒƒæ–‡ä»¶">#</a></h2>
<p><code>CLAUDE.md</code> ä¸æ˜¯ä¸€ä»½ç»™äººè¯»çš„æ–‡æ¡£ï¼Œè€Œæ˜¯ä¸€ä¸ª<strong>ä¸“ä¸º Claude è®¾è®¡çš„ã€Œè¡Œä¸ºå¥‘çº¦ã€</strong>â€”â€”å®ƒè®©å¤§æ¨¡å‹ç†è§£â€œåœ¨è¿™ä¸ªé¡¹ç›®é‡Œï¼Œä½ è¯¥æ€ä¹ˆåšâ€ã€‚</p>
<p>å®ƒçš„æ ¸å¿ƒä»·å€¼åœ¨äºï¼š<strong>å°†å›¢é˜Ÿçº¦å®šï¼ˆç¼–ç é£æ ¼ã€å®‰å…¨çº¢çº¿ã€ä¸Šä¸‹æ–‡ä¾èµ–ï¼‰è½¬åŒ–ä¸º Claude å¯è§£æã€å¯æ‰§è¡Œçš„æŒ‡ä»¤é›†</strong>ï¼Œé¿å…æ¯æ¬¡è¯·æ±‚éƒ½é‡å¤ç²˜è´´è§„åˆ™ã€‚</p>
<p>æ ‡å‡†æ¨¡æ¿å¦‚ä¸‹ï¼ˆä¿å­˜ä¸ºé¡¹ç›®æ ¹ç›®å½•çš„ <code>CLAUDE.md</code>ï¼‰ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-markdown" data-lang="markdown"><span style="display:flex;"><span>---
</span></span><span style="display:flex;"><span>model: claude-3-5-sonnet-20240620
</span></span><span style="display:flex;"><span>max_tokens: 1024
</span></span><span style="display:flex;"><span>temperature: 0.2
</span></span><span style="display:flex;"><span>rules:
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">-</span> &#34;ç”¨ä¸­æ–‡å›å¤ï¼Œç¦ç”¨è‹±æ–‡æœ¯è¯­ï¼ˆå¦‚ &#39;callback&#39; â†’ &#39;å›è°ƒå‡½æ•°&#39;ï¼‰&#34;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">-</span> &#34;æ‰€æœ‰å‡½æ•°å¿…é¡»æ·»åŠ  Type Hints å’Œ Google é£æ ¼ docstring&#34;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">-</span> &#34;ç¦æ­¢ç¡¬ç¼–ç æ•°å­—ï¼ˆé­”æ³•æ•°å­—ï¼‰ï¼Œå¿…é¡»å®šä¹‰å¸¸é‡&#34;
</span></span><span style="display:flex;"><span>context_files:
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">-</span> &#34;pyproject.toml&#34;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">-</span> &#34;src/utils/__init__.py&#34;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">-</span> &#34;docs/ARCHITECTURE.md&#34;
</span></span><span style="display:flex;"><span>---
</span></span><span style="display:flex;"><span># é¡¹ç›®AIåä½œåè®®  
</span></span><span style="display:flex;"><span>æ­¤æ–‡ä»¶å®šä¹‰ Claude åœ¨æœ¬ä»“åº“ä¸­çš„è¡Œä¸ºè¾¹ç•Œï¼š  
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">-</span> ä»…åˆ†æå·²æäº¤æˆ–æš‚å­˜çš„ä»£ç ï¼›  
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">-</span> ä¸ä¿®æ”¹ä»»ä½•æ–‡ä»¶ï¼Œåªæä¾›å»ºè®®ï¼›  
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">-</span> å¯¹ <span style="color:#e6db74">`tests/`</span> ç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œé¢å¤–å¯ç”¨å•å…ƒæµ‹è¯•è§„èŒƒæ£€æŸ¥ã€‚
</span></span></code></pre></div><p>åœ¨ä»£ç ä¸­è¯»å–è¯¥é…ç½®ï¼ˆç¤ºä¾‹ <code>config.py</code>ï¼‰ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> yaml
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> pathlib <span style="color:#f92672">import</span> Path
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">load_claude_config</span>() <span style="color:#f92672">-&gt;</span> dict:
</span></span><span style="display:flex;"><span>    config_path <span style="color:#f92672">=</span> Path(<span style="color:#e6db74">&#34;CLAUDE.md&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> config_path<span style="color:#f92672">.</span>exists():
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">raise</span> <span style="color:#a6e22e">FileNotFoundError</span>(<span style="color:#e6db74">&#34;CLAUDE.md æœªæ‰¾åˆ°ï¼Œè¯·åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»º&#34;</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    content <span style="color:#f92672">=</span> config_path<span style="color:#f92672">.</span>read_text(encoding<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;utf-8&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> content<span style="color:#f92672">.</span>startswith(<span style="color:#e6db74">&#34;---&#34;</span>):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">raise</span> <span style="color:#a6e22e">ValueError</span>(<span style="color:#e6db74">&#34;CLAUDE.md ç¼ºå°‘ YAML frontmatter åˆ†éš”ç¬¦ ---&#34;</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    frontmatter, _ <span style="color:#f92672">=</span> content<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;---&#34;</span>, <span style="color:#ae81ff">2</span>)[<span style="color:#ae81ff">1</span>:]  <span style="color:#75715e"># å–ç¬¬ä¸€ä¸ª --- åã€ç¬¬äºŒä¸ª --- å‰çš„å†…å®¹</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> yaml<span style="color:#f92672">.</span>safe_load(frontmatter)
</span></span></code></pre></div><p>âš ï¸ <strong>ä¸¥æ ¼å®ˆåˆ™</strong>ï¼š</p>
<ul>
<li>YAML ç¼©è¿›å¿…é¡»ä¸º <strong>ç©ºæ ¼</strong>ï¼ˆé Tabï¼‰ï¼Œ<code>rules</code> å’Œ <code>context_files</code> ä¸‹æ¯é¡¹éœ€ <code>- </code> å¼€å¤´ï¼›</li>
<li><code>context_files</code> ä¸­è·¯å¾„ä¸º<strong>ç›¸å¯¹äºé¡¹ç›®æ ¹ç›®å½•</strong>ï¼ˆå³ <code>CLAUDE.md</code> æ‰€åœ¨ä½ç½®ï¼‰ï¼›</li>
<li><strong>ä¸¥ç¦åœ¨ <code>CLAUDE.md</code> ä¸­å†™å…¥å¯†ç ã€Tokenã€å†…éƒ¨ API åœ°å€ç­‰æ•æ„Ÿä¿¡æ¯</strong>â€”â€”å®ƒå¯èƒ½è¢«æ„å¤–æäº¤è‡³å…¬å¼€ä»“åº“ã€‚</li>
</ul>
<p>â“ <strong>æ’éšœæç¤º</strong>ï¼š</p>
<ul>
<li><code>yaml.scanner.ScannerError</code>ï¼Ÿæ£€æŸ¥æ˜¯å¦ç”¨äº†ä¸­æ–‡å…¨è§’ç©ºæ ¼ã€æ˜¯å¦æ¼äº† <code>---</code> æˆ–ç¼©è¿›é”™ä½ï¼›</li>
<li>ä¸­æ–‡ä¹±ç ï¼Ÿç”¨ VS Code ç¡®è®¤æ–‡ä»¶ç¼–ç ä¸º <strong>UTF-8 without BOM</strong>ï¼ˆå³ä¸‹è§’ç‚¹å‡»ç¼–ç  â†’ é€‰æ‹© â€œSave with Encodingâ€ â†’ UTF-8ï¼‰ã€‚</li>
</ul>
<hr>
<h2 id="3-æ„å»ºæœ¬åœ°aiæ ¡éªŒå·¥å…·claude-lint-cli">3. æ„å»ºæœ¬åœ°AIæ ¡éªŒå·¥å…·ï¼šclaude-lint CLI<a hidden class="anchor" aria-hidden="true" href="#3-æ„å»ºæœ¬åœ°aiæ ¡éªŒå·¥å…·claude-lint-cli">#</a></h2>
<p>ç°åœ¨ï¼Œæˆ‘ä»¬å°† <code>CLAUDE.md</code> çš„çº¦æŸåŠ›è½åœ°ä¸ºå¯æ‰§è¡Œçš„å‘½ä»¤è¡Œå·¥å…· â€”â€” <code>claude-lint</code>ï¼Œä¸€ä¸ªèåˆé™æ€åˆ†æä¸ AI æ¨ç†çš„æ™ºèƒ½ linterã€‚</p>
<p>åˆ›å»º <code>claude_lint.py</code>ï¼ˆæ”¯æŒ Python 3.9+ï¼‰ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#!/usr/bin/env python3</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> argparse
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> json
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> sys
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> pathlib <span style="color:#f92672">import</span> Path
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> typing <span style="color:#f92672">import</span> List, Dict, Any
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> anthropic
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> dotenv <span style="color:#f92672">import</span> load_dotenv
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> yaml
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>load_dotenv()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">read_claude_config</span>() <span style="color:#f92672">-&gt;</span> Dict[str, Any]:
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># ï¼ˆå¤ç”¨ä¸ŠèŠ‚çš„ load_claude_config é€»è¾‘ï¼‰</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">pass</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">build_prompt</span>(file_path: str, code: str, config: dict) <span style="color:#f92672">-&gt;</span> str:
</span></span><span style="display:flex;"><span>    rules <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span><span style="color:#f92672">.</span>join(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;- </span><span style="color:#e6db74">{</span>r<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> <span style="color:#66d9ef">for</span> r <span style="color:#f92672">in</span> config<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#34;rules&#34;</span>, []))
</span></span><span style="display:flex;"><span>    context <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> ctx_file <span style="color:#f92672">in</span> config<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#34;context_files&#34;</span>, []):
</span></span><span style="display:flex;"><span>        p <span style="color:#f92672">=</span> Path(ctx_file)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> p<span style="color:#f92672">.</span>exists():
</span></span><span style="display:flex;"><span>            context <span style="color:#f92672">+=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">=== </span><span style="color:#e6db74">{</span>ctx_file<span style="color:#e6db74">}</span><span style="color:#e6db74"> ===</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">{</span>p<span style="color:#f92672">.</span>read_text()[:<span style="color:#ae81ff">500</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">...</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;&#34;&#34;ä½ æ˜¯ä¸€åèµ„æ·± Python å·¥ç¨‹å¸ˆï¼Œè¯·ä¸¥æ ¼æŒ‰ä»¥ä¸‹è§„åˆ™å®¡æŸ¥ä»£ç ï¼š
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">{</span>rules<span style="color:#e6db74">}</span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">å½“å‰å¾…å®¡æ–‡ä»¶ï¼š</span><span style="color:#e6db74">{</span>file_path<span style="color:#e6db74">}</span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">æ–‡ä»¶å†…å®¹ï¼š
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">```python
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">{</span>code<span style="color:#e6db74">}</span><span style="color:#e6db74">
</span></span></span></code></pre></div><p>{context}</p>
<p>è¯·ä¸¥æ ¼è¿”å›æ ‡å‡† JSON æ ¼å¼ï¼Œä»…å«ä¸€ä¸ªå¯¹è±¡ï¼Œé”®ä¸º &ldquo;issues&rdquo;ï¼Œå€¼ä¸ºæ•°ç»„ï¼Œæ¯ä¸ªå…ƒç´ å« lineï¼ˆè¡Œå·ï¼Œæ•´æ•°ï¼‰ã€messageï¼ˆä¸­æ–‡æè¿°ï¼‰ã€severityï¼ˆ&ldquo;error&rdquo;|&ldquo;warning&rdquo;ï¼‰ã€‚ç¦æ­¢ä»»ä½•é¢å¤–æ–‡æœ¬ã€è§£é‡Šæˆ– Markdown æ ¼å¼ã€‚&quot;&quot;&quot;</p>
<p>def main():
parser = argparse.ArgumentParser(description=&ldquo;Claude AI-powered code linter&rdquo;)
parser.add_argument(&quot;&ndash;file&quot;, help=&ldquo;æŒ‡å®šå•ä¸ªæ–‡ä»¶è·¯å¾„&rdquo;)
parser.add_argument(&quot;&ndash;staged&quot;, action=&ldquo;store_true&rdquo;, help=&ldquo;æ£€æŸ¥ Git æš‚å­˜åŒºæ–‡ä»¶&rdquo;)
parser.add_argument(&quot;&ndash;dry-run&quot;, action=&ldquo;store_true&rdquo;, help=&ldquo;ä»…æ‰“å° promptï¼Œä¸è°ƒç”¨ API&rdquo;)
args = parser.parse_args()</p>
<pre><code>config = read_claude_config()
client = anthropic.Anthropic()

files_to_check = []
if args.file:
    files_to_check = [Path(args.file)]
elif args.staged:
    # è·å–æš‚å­˜æ–‡ä»¶ï¼ˆç®€åŒ–ç‰ˆï¼Œç”Ÿäº§ç¯å¢ƒå»ºè®®ç”¨ gitpythonï¼‰
    import subprocess
    result = subprocess.run([&quot;git&quot;, &quot;diff&quot;, &quot;--cached&quot;, &quot;--name-only&quot;, &quot;--diff-filter=ACM&quot;], 
                          capture_output=True, text=True)
    files_to_check = [Path(f) for f in result.stdout.strip().split(&quot;\n&quot;) if f.endswith(&quot;.py&quot;)]

for fp in files_to_check:
    if not fp.exists():
        continue
    code = fp.read_text()
    prompt = build_prompt(str(fp), code, config)
    
    if args.dry_run:
        print(f&quot;\nğŸ“„ {fp} Prompt:\n{prompt[:300]}...\n&quot;)
        continue

    try:
        msg = client.messages.create(
            model=config[&quot;model&quot;],
            max_tokens=config[&quot;max_tokens&quot;],
            temperature=config[&quot;temperature&quot;],
            messages=[{&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: prompt}]
        )
        # è§£æ JSON å“åº”ï¼ˆClaude å¯èƒ½åŒ…è£¹åœ¨ ```json ... ``` ä¸­ï¼‰
        resp_text = msg.content[0].text.strip()
        if resp_text.startswith(&quot;```json&quot;):
            resp_text = resp_text[7:-3].strip()
        result = json.loads(resp_text)
        
        if result.get(&quot;issues&quot;):
            print(f&quot;\nğŸ” {fp}:&quot;)
            for issue in result[&quot;issues&quot;]:
                print(f&quot;  âš ï¸  L{issue['line']}: {issue['message']} ({issue['severity']})&quot;)
            sys.exit(1)
    except json.JSONDecodeError as e:
        print(f&quot;âŒ JSON è§£æå¤±è´¥ï¼ˆClaude è¿”å›éæ ‡å‡†æ ¼å¼ï¼‰: {e}&quot;)
        print(&quot;Raw response:&quot;, msg.content[0].text[:200])
    except Exception as e:
        print(f&quot;âŒ API è°ƒç”¨å¼‚å¸¸: {e}&quot;)
</code></pre>
<p>if <strong>name</strong> == &ldquo;<strong>main</strong>&rdquo;:
main()</p>
<pre tabindex="0"><code>
èµ‹äºˆå¯æ‰§è¡Œæƒé™ï¼ˆLinux/macOSï¼‰ï¼š  
```bash
chmod +x claude_lint.py
</code></pre><p>âš ï¸ <strong>å…³é”®å·¥ç¨‹å®è·µ</strong>ï¼š</p>
<ul>
<li>Token å®‰å…¨ï¼šå¯¹è¶…é•¿æ–‡ä»¶ï¼ˆ&gt;2000 è¡Œï¼‰åš AST é¢„æ‰«æï¼Œä»…æå–å‡½æ•°ç­¾åã€docstringã€æ ¸å¿ƒé€»è¾‘å—é€å…¥ Claudeï¼›</li>
<li><code>--dry-run</code> æ˜¯è°ƒè¯•ç¥å™¨ï¼Œå¯å¿«é€ŸéªŒè¯ prompt æ•ˆæœï¼›</li>
<li>ç”Ÿäº§ç¯å¢ƒåŠ¡å¿…åŠ  <code>timeout=120</code> å‚æ•°åˆ° <code>client.messages.create()</code>ã€‚</li>
</ul>
<p>â“ <strong>é«˜é¢‘é—®é¢˜</strong>ï¼š</p>
<ul>
<li>Claude è¿”å› <code>&quot;issues&quot;: []</code> å´ä»æŠ¥é”™ï¼Ÿæ£€æŸ¥ JSON ä¸­æ˜¯å¦æ··å…¥äº†æ³¨é‡Šï¼ˆå¦‚ <code>// æ— é—®é¢˜</code>ï¼‰ï¼ŒAI ä¸¥æ ¼éµå¾ªâ€œä»…è¿”å› JSONâ€æŒ‡ä»¤ï¼›</li>
<li>å¤§æ–‡ä»¶è¶…æ—¶ï¼Ÿå¢åŠ é‡è¯•é€»è¾‘ï¼ˆ<code>tenacity</code> åº“ï¼‰æˆ–å¯ç”¨æµå¼åˆ†å—åˆ†æã€‚</li>
</ul>
<hr>
<h2 id="4-é›†æˆgité¢„æäº¤é’©å­pre-commit-hook">4. é›†æˆGité¢„æäº¤é’©å­ï¼ˆPre-commit Hookï¼‰<a hidden class="anchor" aria-hidden="true" href="#4-é›†æˆgité¢„æäº¤é’©å­pre-commit-hook">#</a></h2>
<p>è®© AI æ ¡éªŒæˆä¸ºå¼€å‘æµç¨‹çš„â€œç©ºæ°”â€â€”â€”æ— éœ€æ‰‹åŠ¨è§¦å‘ï¼Œæ¯æ¬¡ <code>git commit</code> è‡ªåŠ¨è¿è¡Œã€‚</p>
<p>åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»º <code>.pre-commit-config.yaml</code>ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">repos</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">repo</span>: <span style="color:#ae81ff">local</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">hooks</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">id</span>: <span style="color:#ae81ff">claude-lint</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">name</span>: <span style="color:#ae81ff">Claude AI Code Review</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">entry</span>: <span style="color:#ae81ff">python claude_lint.py --staged</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">language</span>: <span style="color:#ae81ff">system</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">types</span>: [<span style="color:#ae81ff">python]</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">pass_filenames</span>: <span style="color:#66d9ef">false</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># âš ï¸ æ³¨æ„ï¼šWindows ç”¨æˆ·å¯æ”¹ä¸º `entry: python claude_lint.py --staged`</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># è‹¥ claude_lint.py ä¸åœ¨ PATHï¼Œç”¨ç»å¯¹è·¯å¾„ï¼š`entry: python /abs/path/to/claude_lint.py`</span>
</span></span></code></pre></div><p>å®‰è£…å¹¶å¯ç”¨é’©å­ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>pip install pre-commit
</span></span><span style="display:flex;"><span>pre-commit install
</span></span></code></pre></div><p>éªŒè¯æ•ˆæœï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;def hello(): return &#39;world&#39;&#34;</span> &gt; bad.py
</span></span><span style="display:flex;"><span>git add bad.py
</span></span><span style="display:flex;"><span>git commit -m <span style="color:#e6db74">&#34;test: add bad code&#34;</span>  <span style="color:#75715e"># æ­¤æ—¶åº”è¢«æ‹¦æˆªå¹¶æŠ¥å‡ºç±»å‹ç¼ºå¤±è­¦å‘Š</span>
</span></span></code></pre></div><p>è¿›é˜¶æŠ€å·§ï¼š</p>
<ul>
<li>ä¸´æ—¶è·³è¿‡ï¼š<code>SKIP=claude-lint git commit -m &quot;skip ai check&quot;</code>ï¼›</li>
<li>æ‰‹åŠ¨è§¦å‘ï¼š<code>pre-commit run claude-lint --hook-stage manual</code>ï¼›</li>
<li>æ€§èƒ½å…œåº•ï¼šåœ¨ <code>.pre-commit-config.yaml</code> ä¸­ä¸ºè¯¥ hook æ·»åŠ  <code>timeout: 120</code>ã€‚</li>
</ul>
<p>âš ï¸ <strong>é¿å‘æŒ‡å—</strong>ï¼š</p>
<ul>
<li>é’©å­å·¥ä½œç›®å½•å§‹ç»ˆä¸º Git ä»“åº“æ ¹ç›®å½•ï¼Œæ‰€æœ‰è·¯å¾„ï¼ˆå¦‚ <code>CLAUDE.md</code>ï¼‰å‡ä»¥æ­¤ä¸ºåŸºå‡†ï¼›</li>
<li>Windows ä¸‹è‹¥æç¤º <code>python: command not found</code>ï¼Œæ”¹ç”¨ <code>entry: python3</code> æˆ–å®Œæ•´è·¯å¾„ <code>C:\Python39\python.exe</code>ã€‚</li>
</ul>
<p><img alt="å±•ç¤º pre-commit é’©å­æ‹¦æˆªè¿è§„æäº¤çš„ç»ˆç«¯æˆªå›¾" loading="lazy" src="IMAGE_PLACEHOLDER_2"></p>
<hr>
<h2 id="5-å®æˆ˜æ¡ˆä¾‹ä¿®å¤ä¸€ä¸ªçœŸå®prä¸­çš„aiæ ¡éªŒé—®é¢˜">5. å®æˆ˜æ¡ˆä¾‹ï¼šä¿®å¤ä¸€ä¸ªçœŸå®PRä¸­çš„AIæ ¡éªŒé—®é¢˜<a hidden class="anchor" aria-hidden="true" href="#5-å®æˆ˜æ¡ˆä¾‹ä¿®å¤ä¸€ä¸ªçœŸå®prä¸­çš„aiæ ¡éªŒé—®é¢˜">#</a></h2>
<p>å‡è®¾æŸ PR æ–°å¢ <code>src/math.py</code>ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># src/math.py</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">calculate</span>(a, b):  <span style="color:#75715e"># âŒ æ— ç±»å‹æç¤º</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> a <span style="color:#f92672">*</span> b <span style="color:#f92672">+</span> <span style="color:#ae81ff">5</span>  <span style="color:#75715e"># âŒ é­”æ³•æ•°å­— 5</span>
</span></span></code></pre></div><p>è¿è¡Œæ ¡éªŒï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>python claude_lint.py --file src/math.py
</span></span></code></pre></div><p>Claude è¿”å›ï¼ˆæ¨¡æ‹Ÿï¼‰ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;issues&#34;</span>: [
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;line&#34;</span>: <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;message&#34;</span>: <span style="color:#e6db74">&#34;å‡½æ•° calculate ç¼ºå°‘ç±»å‹æç¤ºï¼Œè¯·è¡¥å……å‚æ•°å’Œè¿”å›å€¼ç±»å‹&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;severity&#34;</span>: <span style="color:#e6db74">&#34;error&#34;</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;line&#34;</span>: <span style="color:#ae81ff">2</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;message&#34;</span>: <span style="color:#e6db74">&#34;ç¬¬2è¡Œå‡ºç°é­”æ³•æ•°å­— 5ï¼Œåº”å®šä¹‰ä¸ºå¸¸é‡ MAX_MULTIPLY_OFFSET&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;severity&#34;</span>: <span style="color:#e6db74">&#34;warning&#34;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  ]
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>ä¿®å¤å <code>src/math.py</code>ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># src/math.py</span>
</span></span><span style="display:flex;"><span>MAX_MULTIPLY_OFFSET <span style="color:#f92672">=</span> <span style="color:#ae81ff">5</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">calculate</span>(a: float, b: float) <span style="color:#f92672">-&gt;</span> float:
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;è®¡ç®— a ä¸ b çš„ä¹˜ç§¯å¹¶åŠ ä¸Šåç§»é‡&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> a <span style="color:#f92672">*</span> b <span style="color:#f92672">+</span> MAX_MULTIPLY_OFFSET
</span></span></code></pre></div><p>å†æ¬¡ <code>git commit</code>ï¼Œé’©å­è¾“å‡ºï¼š<br>
<code>âœ… No issues found â€” Claude AI review passed.</code></p>
<p>âš ï¸ <strong>äººæœºååŒé»„é‡‘æ³•åˆ™</strong>ï¼š</p>
<ul>
<li>AI æ˜¯â€œé«˜çº§åä½œè€…â€ï¼Œä¸æ˜¯â€œä»£ç è­¦å¯Ÿâ€â€”â€”å¼€å‘è€…æœ‰æƒå¦å†³å»ºè®®ï¼ˆå¦‚æŸå¤„æ•…æ„ä¸ç”¨ç±»å‹æç¤ºï¼‰ï¼›</li>
<li><code>CLAUDE.md</code> ä¸­çš„ <code>rules</code> åº”èšç„¦<strong>å¯åˆ¤å®šã€å¯å…±è¯†ã€å¯è‡ªåŠ¨åŒ–</strong>çš„è§„èŒƒï¼Œé¿å…ä¸»è§‚è¡¨è¿°ï¼ˆå¦‚â€œä»£ç è¦ä¼˜é›…â€ï¼‰ã€‚</li>
</ul>
<p>â“ <strong>å…¸å‹è¯¯æŠ¥åœºæ™¯</strong>ï¼š</p>
<ul>
<li>è§„åˆ™å†™æˆ <code>&quot;ç¦æ­¢ print()&quot;</code>ï¼Œä½†æ—¥å¿—è°ƒè¯•éœ€ <code>print()</code> â†’ åº”ç»†åŒ–ä¸º <code>&quot;ç¦æ­¢åœ¨ production ä»£ç ä¸­ä½¿ç”¨ printï¼Œæ”¹ç”¨ logging&quot;</code>ï¼›</li>
<li>å¤šæ–‡ä»¶é€»è¾‘ï¼ˆå¦‚ <code>utils.py</code> ä¸­å‡½æ•°è¢« <code>api.py</code> è°ƒç”¨ï¼‰æœªçº³å…¥ <code>context_files</code> â†’ è¡¥å……ç›¸å…³è·¯å¾„å³å¯ã€‚</li>
</ul>
<p><img alt="å±•ç¤ºä¿®å¤å‰åä»£ç å¯¹æ¯”åŠé€šè¿‡æ ¡éªŒçš„ç»ˆç«¯æˆªå›¾" loading="lazy" src="IMAGE_PLACEHOLDER_3"></p>
<hr>
<h2 id="6-è¿ç»´ä¸è°ƒä¼˜æŒ‡å—">6. è¿ç»´ä¸è°ƒä¼˜æŒ‡å—<a hidden class="anchor" aria-hidden="true" href="#6-è¿ç»´ä¸è°ƒä¼˜æŒ‡å—">#</a></h2>
<p>è®© <code>claude-lint</code> åœ¨å›¢é˜Ÿä¸­é•¿æœŸç¨³å®šæœå½¹ï¼Œéœ€å…³æ³¨ä¸‰ä»¶äº‹ï¼š<strong>å¯è§‚æµ‹ã€å¯é™çº§ã€å¯ä¼˜åŒ–</strong>ã€‚</p>
<h3 id="-æˆæœ¬ç›‘æ§">âœ… æˆæœ¬ç›‘æ§<a hidden class="anchor" aria-hidden="true" href="#-æˆæœ¬ç›‘æ§">#</a></h3>
<p>åœ¨ <code>claude_lint.py</code> çš„ API è°ƒç”¨åæ·»åŠ æ—¥å¿—ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;[STATS] Input: </span><span style="color:#e6db74">{</span>msg<span style="color:#f92672">.</span>usage<span style="color:#f92672">.</span>input_tokens<span style="color:#e6db74">}</span><span style="color:#e6db74">, Output: </span><span style="color:#e6db74">{</span>msg<span style="color:#f92672">.</span>usage<span style="color:#f92672">.</span>output_tokens<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">with</span> open(<span style="color:#e6db74">&#34;claude-stats.log&#34;</span>, <span style="color:#e6db74">&#34;a&#34;</span>) <span style="color:#66d9ef">as</span> f:
</span></span><span style="display:flex;"><span>    f<span style="color:#f92672">.</span>write(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{</span>datetime<span style="color:#f92672">.</span>now()<span style="color:#e6db74">}</span><span style="color:#e6db74">,</span><span style="color:#e6db74">{</span>fp<span style="color:#e6db74">}</span><span style="color:#e6db74">,</span><span style="color:#e6db74">{</span>msg<span style="color:#f92672">.</span>usage<span style="color:#f92672">.</span>input_tokens<span style="color:#e6db74">}</span><span style="color:#e6db74">,</span><span style="color:#e6db74">{</span>msg<span style="color:#f92672">.</span>usage<span style="color:#f92672">.</span>output_tokens<span style="color:#e6db74">}</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
</span></span></code></pre></div><h3 id="-é™çº§ç­–ç•¥">âœ… é™çº§ç­–ç•¥<a hidden class="anchor" aria-hidden="true" href="#-é™çº§ç­–ç•¥">#</a></h3>
<p>å½“ Anthropic API ä¸å¯ç”¨æ—¶ï¼Œfallback åˆ°ä¼ ç»Ÿ linterï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">except</span> anthropic<span style="color:#f92672">.</span>APIConnectionError:
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;âš ï¸  Claude ä¸å¯ç”¨ï¼Œé™çº§æ‰§è¡Œ pylint...&#34;</span>)
</span></span><span style="display:flex;"><span>    subprocess<span style="color:#f92672">.</span>run([<span style="color:#e6db74">&#34;pylint&#34;</span>, <span style="color:#e6db74">&#34;--errors-only&#34;</span>, str(fp)])
</span></span></code></pre></div><h3 id="-æ€§èƒ½ä¼˜åŒ–">âœ… æ€§èƒ½ä¼˜åŒ–<a hidden class="anchor" aria-hidden="true" href="#-æ€§èƒ½ä¼˜åŒ–">#</a></h3>
<p>å¯¹ <code>.py</code> æ–‡ä»¶å…ˆåš AST å¿«é€Ÿæ‰«æï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> ast
</span></span><span style="display:flex;"><span>tree <span style="color:#f92672">=</span> ast<span style="color:#f92672">.</span>parse(code)
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ä»…æå– FunctionDefã€ClassDefã€Assign èŠ‚ç‚¹ï¼Œè·³è¿‡å­—ç¬¦ä¸²/æ³¨é‡Š</span>
</span></span></code></pre></div><h3 id="-å®‰å…¨åŠ å›º">âœ… å®‰å…¨åŠ å›º<a hidden class="anchor" aria-hidden="true" href="#-å®‰å…¨åŠ å›º">#</a></h3>
<p>æ ¡éªŒ <code>CLAUDE.md</code> ä¸­çš„ <code>context_files</code> æ˜¯å¦åœ¨ç™½åå•å†…ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>SAFE_PATTERNS <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#34;*.py&#34;</span>, <span style="color:#e6db74">&#34;*.toml&#34;</span>, <span style="color:#e6db74">&#34;*.md&#34;</span>]
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> p <span style="color:#f92672">in</span> config<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#34;context_files&#34;</span>, []):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> any(Path(p)<span style="color:#f92672">.</span><span style="color:#66d9ef">match</span>(pat) <span style="color:#66d9ef">for</span> pat <span style="color:#f92672">in</span> SAFE_PATTERNS):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">raise</span> <span style="color:#a6e22e">ValueError</span>(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;ä¸å®‰å…¨çš„ä¸Šä¸‹æ–‡æ–‡ä»¶è·¯å¾„: </span><span style="color:#e6db74">{</span>p<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span></code></pre></div><p>âš ï¸ <strong>CI/CD ç‰¹åˆ«æé†’</strong>ï¼š</p>
<ul>
<li>GitHub Actions ä¸­ï¼Œ<strong>æ°¸è¿œé€šè¿‡ Secrets æ³¨å…¥ <code>ANTHROPIC_API_KEY</code></strong>ï¼Œç¦æ­¢æ˜æ–‡å†™å…¥ workflow YAMLï¼›</li>
<li>è®¾ç½® <code>--max-files 3</code> é™åˆ¶å•æ¬¡æ ¡éªŒæ•°é‡ï¼Œé˜²æ­¢å•æ¬¡ PR è§¦å‘è¿‡å¤š API è°ƒç”¨ï¼›</li>
<li>ä¼ä¸šé˜²ç«å¢™ï¼Ÿæå‰åœ¨ CI runner ä¸Šé…ç½®å¯ä¿¡ CA è¯ä¹¦æˆ–å…è®¸ <code>api.anthropic.com:443</code> å‡ºç«™ã€‚</li>
</ul>
<p><img alt="å±•ç¤º claude-stats.log æ—¥å¿—æ ¼å¼ä¸ CI é…ç½®ç¤ºæ„å›¾" loading="lazy" src="IMAGE_PLACEHOLDER_4"></p>
<p>è‡³æ­¤ï¼Œä½ å·²æ„å»ºäº†ä¸€å¥—å¼€ç®±å³ç”¨ã€å®‰å…¨å¯æ§ã€å¯æŒç»­æ¼”è¿›çš„ AI å¢å¼ºå‹ä»£ç è´¨é‡ä½“ç³»ã€‚å®ƒä¸æ›¿ä»£å·¥ç¨‹å¸ˆçš„åˆ¤æ–­ï¼Œè€Œæ˜¯æŠŠé‡å¤ã€æœºæ¢°ã€æ˜“ç–æ¼çš„å®¡æŸ¥å·¥ä½œäº¤ç»™ AIï¼Œè®©äººä¸“æ³¨åœ¨çœŸæ­£éœ€è¦åˆ›é€ åŠ›çš„åœ°æ–¹â€”â€”è®¾è®¡ã€æƒè¡¡ä¸çªç ´ã€‚</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://localhost:1313/tags/claude/">Claude</a></li>
      <li><a href="http://localhost:1313/tags/ai%E7%BC%96%E7%A8%8B/">AIç¼–ç¨‹</a></li>
      <li><a href="http://localhost:1313/tags/git%E9%92%A9%E5%AD%90/">Gité’©å­</a></li>
      <li><a href="http://localhost:1313/tags/python/">Python</a></li>
      <li><a href="http://localhost:1313/tags/devops/">DevOps</a></li>
      <li><a href="http://localhost:1313/tags/api%E9%9B%86%E6%88%90/">APIé›†æˆ</a></li>
    </ul>
  </footer><script src="https://giscus.app/client.js"
        data-repo="zhitongblog/my-blog"
        data-repo-id="R_kgDORBRArg"
        data-category="Announcements"
        data-category-id="DIC_kwDORBRArs4C188Z"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="bottom"
        data-theme="light"
        data-lang="zh-CN"
        crossorigin="anonymous"
        async>
</script>

</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2026 <a href="http://localhost:1313/">æ™ºé€šå’Œä½ ä¸€èµ·å­¦AI</a></span> Â· 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu');
    if (menu) {
        
        const scrollPosition = localStorage.getItem("menu-scroll-position");
        if (scrollPosition) {
            menu.scrollLeft = parseInt(scrollPosition, 10);
        }
        
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        const html = document.querySelector("html");
        if (html.dataset.theme === "dark") {
            html.dataset.theme = 'light';
            localStorage.setItem("pref-theme", 'light');
        } else {
            html.dataset.theme = 'dark';
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
